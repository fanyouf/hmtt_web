(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65164d2b"],{"018e":function(t,e,n){"use strict";n("f99a")},"37c2":function(t,e,n){},"50d1":function(t,e,n){"use strict";n("8672")},8672:function(t,e,n){},c24f:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return o})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return s})),n.d(e,"f",(function(){return l})),n.d(e,"g",(function(){return u}));var a=n("b775"),r=function(t,e){return Object(a["a"])({method:"POST",url:"/app/v1_0/authorizations",data:{mobile:t,code:e}})},i=function(){return Object(a["a"])({method:"GET",url:"/app/v1_0/user/profile"})},o=function(t){return Object(a["a"])({method:"DELETE",url:"/app/v1_0/user/followings/"+t})},c=function(t){return Object(a["a"])({method:"POST",url:"/app/v1_0/user/followings",data:{target:t}})},s=function(){return Object(a["a"])({method:"GET",url:"/app/v1_0/user"})},l=function(t){return Object(a["a"])({method:"PATCH",url:"/app/v1_0/user/profile",data:t})},u=function(t){return Object(a["a"])({method:"PATCH",url:"/app/v1_0/user/photo",data:t})}},cccf:function(t,e,n){"use strict";n("37c2")},f2b4:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-container"},[n("van-nav-bar",{attrs:{fixed:"","left-arrow":"",title:"文章详情-"+t.article.title},on:{"click-left":function(e){return t.$router.back()}}}),t.loading?n("van-loading",{staticClass:"article-loading"}):t._e(),t.is404?n("div",{staticClass:"error"},[n("p",[t._v("文章被外星人吃掉了")]),n("van-button",{on:{click:function(e){return t.$router.back()}}},[t._v("后退")]),n("van-button",{on:{click:function(e){return t.$router.push("/")}}},[t._v("回主页")])],1):n("div",{staticClass:"detail"},[n("h3",{staticClass:"title"},[t._v(t._s(t.article.title))]),n("div",{staticClass:"author"},[n("van-image",{attrs:{round:"",width:"1rem",height:"1rem",fit:"fill"}}),n("div",{staticClass:"text"},[n("p",{staticClass:"name"},[t._v(t._s(t.article.aut_name))]),n("p",{staticClass:"time"},[t._v(t._s(t._f("relativeTime")(t.article.pubdate)))])]),t.article.aut_id!==t.$store.state.userInfo.id?n("van-button",{attrs:{round:"",size:"small",type:"info"},on:{click:t.hSwitchFollow}},[t._v(t._s(t.article.is_followed?"取关":"+ 关注"))]):t._e()],1),n("div",{staticClass:"content"},[n("div",{domProps:{innerHTML:t._s(t.article.content)}})]),n("van-divider",[t._v("END")]),n("div",{staticClass:"zan"},[n("van-button",{attrs:{round:"",size:"small",hairline:"",type:"primary",plain:"",icon:"good-job-o"}},[t._v("点赞")]),t._v(" "),n("van-button",{attrs:{round:"",size:"small",hairline:"",type:"danger",plain:"",icon:"delete"}},[t._v("不喜欢")])],1)],1),n("article-comment",{attrs:{articleId:t.articleId}})],1)},r=[],i=(n("96cf"),n("1da1")),o=n("c24f"),c=n("2423"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-comments"},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return n("van-cell",{key:e.com_id.toString()},[n("van-image",{staticStyle:{"margin-right":"10px"},attrs:{slot:"icon",round:"",width:"30",height:"30",src:e.aut_photo},slot:"icon"}),n("span",{staticStyle:{color:"#466b9d"},attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.aut_name))]),n("div",{attrs:{slot:"label"},slot:"label"},[n("p",{staticStyle:{color:"#363636"}},[t._v(t._s(e.content))]),n("p",[n("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("relativeTime")(e.pubdate)))]),n("van-button",{attrs:{size:"mini",type:"default"},on:{click:function(n){return t.hClickReply(e)}}},[t._v("回复")])],1)]),n("van-icon",{attrs:{slot:"right-icon",name:e.is_liking?"like":"like-o"},slot:"right-icon"})],1)})),1),n("van-cell-group",{staticClass:"publish-wrap"},[n("van-field",{attrs:{clearable:"",placeholder:"请输入评论内容"},model:{value:t.content,callback:function(e){t.content="string"===typeof e?e.trim():e},expression:"content"}},[n("van-button",{attrs:{slot:"button",size:"mini",type:"info"},on:{click:t.hAddComment},slot:"button"},[t._v("发布")])],1)],1),n("van-popup",{style:{height:"85%"},attrs:{round:"",position:"bottom"},model:{value:t.isReplyShow,callback:function(e){t.isReplyShow=e},expression:"isReplyShow"}},[t.isReplyShow?n("comment-reply",{attrs:{comment:t.currentComment,articleId:t.articleId},on:{"close-reply":function(e){t.isReplyShow=!1}}}):t._e()],1)],1)},l=[],u=n("2909"),d=n("b775"),p=function(t,e){return Object(d["a"])({method:"POST",url:"/app/v1_0/comments",data:{target:t,content:e}})},m=function(t,e){return Object(d["a"])({method:"GET",url:"/app/v1_0/comments",params:{type:"a",source:t,offset:e}})},f=function(t,e){return Object(d["a"])({method:"GET",url:"/app/v1_0/comments",params:{type:"c",source:t,offset:e}})},v=function(t,e,n){return Object(d["a"])({method:"POST",url:"/app/v1_0/comments",data:{target:t,art_id:e,content:n}})},h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-comments"},[n("van-nav-bar",{attrs:{title:t.comment.reply_count+"条回复"}},[n("van-icon",{attrs:{slot:"left",name:"cross"},on:{click:function(e){return t.$emit("close-reply")}},slot:"left"})],1),n("van-cell",{attrs:{title:"当前评论"}},[n("van-image",{staticStyle:{"margin-right":"10px"},attrs:{slot:"icon",round:"",width:"30",height:"30",src:t.comment.aut_photo},slot:"icon"}),n("span",{staticStyle:{color:"#466b9d"},attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.comment.aut_name))]),n("div",{attrs:{slot:"label"},slot:"label"},[n("p",{staticStyle:{color:"#363636"}},[t._v(t._s(t.comment.content))]),n("p",[n("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("relativeTime")(t.comment.pubdate)))]),n("van-button",{attrs:{size:"mini",type:"default"}},[t._v("回复 "+t._s(t.comment.reply_count))])],1)]),n("van-icon",{attrs:{slot:"right-icon"},slot:"right-icon"})],1),n("van-divider",[t._v("全部回复")]),n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e,a){return n("van-cell",{key:a},[n("van-image",{staticStyle:{"margin-right":"10px"},attrs:{slot:"icon",round:"",width:"30",height:"30",src:e.aut_photo},slot:"icon"}),n("span",{staticStyle:{color:"#466b9d"},attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.aut_name))]),n("div",{attrs:{slot:"label"},slot:"label"},[n("p",{staticStyle:{color:"#363636"}},[t._v(t._s(e.content))]),n("p",[n("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("relativeTime")(e.pubdate)))])])])],1)})),1),n("van-cell-group",{staticClass:"publish-wrap"},[n("van-field",{attrs:{clearable:"",placeholder:"请输入回复内容"},model:{value:t.content,callback:function(e){t.content="string"===typeof e?e.trim():e},expression:"content"}},[n("van-button",{attrs:{slot:"button",size:"mini",type:"info"},on:{click:t.hAddReply},slot:"button"},[t._v("发布")])],1)],1)],1)},_=[],b=(n("d3b7"),n("25f0"),{name:"CommentReply",props:{articleId:{type:String,required:!0},comment:{type:Object,required:!0}},data:function(){return{content:"",offset:null,list:[],loading:!1,finished:!1}},created:function(){},methods:{onLoad:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f(t.comment.com_id.toString(),t.offset);case 3:a=e.sent,r=a.data.data.results,(n=t.list).push.apply(n,Object(u["a"])(r)),t.loading=!1,t.finished=!r.length,t.offset=a.data.data.last_id,e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](0),t.$toast("获取评论回复失败"),t.loading=!1;case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},hAddReply:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==t.content){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,v(t.comment.com_id.toString(),t.articleId,t.content);case 5:n=e.sent,t.list.unshift(n.data.data.new_obj),t.comment.reply_count++,e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](2);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))()}}}),g=b,y=(n("018e"),n("2877")),w=Object(y["a"])(g,h,_,!1,null,"535a9507",null),x=w.exports,k={name:"ArticleComment",props:{articleId:{type:String,required:!0}},components:{CommentReply:x},data:function(){return{currentComment:{},isReplyShow:!1,offset:null,content:"",list:[],loading:!1,finished:!1}},methods:{hAddComment:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==t.content){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,p(t.articleId,t.content);case 5:n=e.sent,t.list.unshift(n.data.data.new_obj),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),t.$toast.fail("评论失败");case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()},onLoad:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m(t.articleId,t.offset);case 3:a=e.sent,r=a.data.data.results,(n=t.list).push.apply(n,Object(u["a"])(r)),t.loading=!1,t.finished=!r.length,t.offset=a.data.data.last_id,e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](0),t.$toast("获取评论失败"),t.loading=!1;case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},hClickReply:function(t){this.currentComment=t,this.isReplyShow=!0}}},O=k,S=(n("50d1"),Object(y["a"])(O,s,l,!1,null,"a3484de2",null)),j=S.exports,C={name:"ArticleIndex",components:{ArticleComment:j},data:function(){return{articleId:"",is404:!1,loading:!0,article:{}}},created:function(){this.articleId=this.$route.params.id,this.loadDetail()},methods:{loadDetail:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.is404=!1,t.loading=!0,e.next=5,Object(c["c"])(t.$route.params.id);case 5:n=e.sent,t.article=n.data.data,t.loading=!1,e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](0),t.loading=!1,404===e.t0.response.status&&(t.is404=!0);case 15:case"end":return e.stop()}}),e,null,[[0,10]])})))()},hSwitchFollow:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.article,a=n.is_followed,r=n.aut_id,e.prev=1,!a){e.next=11;break}return e.next=5,Object(o["e"])(r);case 5:e.sent,t.$toast.success("取关成功"),t.article.is_followed=!1,e.next=17;break;case 11:return e.next=13,Object(o["a"])(r);case 13:e.sent,t.$toast.success("加关成功"),t.article.is_followed=!0;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e["catch"](1),t.$toast.fail("操作失败");case 23:case"end":return e.stop()}}),e,null,[[1,19]])})))()}}},R=C,T=(n("cccf"),Object(y["a"])(R,a,r,!1,null,"fa32d6ca",null));e["default"]=T.exports},f99a:function(t,e,n){}}]);